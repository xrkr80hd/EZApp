# EZApp .htaccess Configuration

# Created: January 4, 2026

# ============================================

# HTTPS Redirect (Force SSL)

# ============================================

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

# ============================================

# Security Headers

# ============================================

<IfModule mod_headers.c>
    # Prevent clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"

    # XSS Protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # Referrer Policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Content Security Policy (allows images and SVGs)
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'; media-src 'self' blob:; object-src 'none'; frame-ancestors 'self';"
</IfModule>

# ============================================

# Default Document

# ============================================

DirectoryIndex index.html login.html

# ============================================

# Prevent Directory Browsing

# ============================================

Options -Indexes

# ============================================

# Protect Sensitive Files

# ============================================

<FilesMatch "(^#.*#|\.(bak|conf|dist|fla|in[ci]|log|psd|sh|sql|sw[op])|~)$">
    Require all denied
</FilesMatch>

# Protect config files

<Files "config.php">
    Require all denied
</Files>

<Files "database.php">
    Require all denied
</Files>

# Protect htaccess itself

<Files ".htaccess">
    Require all denied
</Files>

# ============================================

# PHP Settings (if applicable)

# ============================================

<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag log_errors On
    php_value max_execution_time 300
    php_value upload_max_filesize 20M
    php_value post_max_size 25M
</IfModule>

# ============================================

# MIME Types

# ============================================

<IfModule mod_mime.c>
    AddType image/svg+xml svg svgz
    AddEncoding gzip svgz
</IfModule>

# ============================================

# Cache Control for Assets

# ============================================

<IfModule mod_expires.c>
    ExpiresActive On

    # Images
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    
    # CSS and JavaScript
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    
    # Fonts
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    
    # HTML
    ExpiresByType text/html "access plus 0 seconds"
</IfModule>

# ============================================

# GZIP Compression

# ============================================

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# ============================================

# Optional: HTTP Basic Auth (Uncomment to enable)

# ============================================

# <IfModule mod_authn_file.c>

# AuthType Basic

# AuthName "EZ App â€” Private Access"

# # Replace with absolute path on server (e.g., /home/username/public_html/ezapp/.htpasswd)

# AuthUserFile "/absolute/path/to/.htpasswd"

# Require valid-user

# </IfModule>

# ============================================

# Custom Error Pages (Create these if needed)

# ============================================

# ErrorDocument 404 /404.html

# ErrorDocument 403 /403.html

# ErrorDocument 500 /500.html
